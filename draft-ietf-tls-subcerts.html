<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Delegated Credentials for TLS</title>
<meta content="Richard Barnes" name="author">
<meta content="Subodh Iyengar" name="author">
<meta content="Nick Sullivan" name="author">
<meta content="Eric Rescorla" name="author">
<meta content="
       The organizational separation between the operator of a TLS endpoint and the
certification authority can create limitations.  For example, the lifetime of
certificates, how they may be used, and the algorithms they support are
ultimately determined by the certification authority.  This document describes a
mechanism by which operators may delegate their own credentials for use in TLS,
without breaking compatibility with peers that do not support this
specification. 
    " name="description">
<meta content="xml2rfc 2.42.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-tls-subcerts-latest" name="ietf.draft">
<link href="draft-ietf-tls-subcerts.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --small-font-size: 14.5px;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  padding: 1em 0 0.2em;
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1, h2, h3 {
  font-size: 22px;
  line-height: 26px;
}
h4, h5, h6 {
  font-size: 18px;
  line-height: 22px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
  table {
    display: inline-block;
    overflow-x: auto;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #eee;
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 1em;
  border-top: 1px solid var(--line-color);
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  visibility: hidden;
  user-select: none;
}
a.pilcrow[href] { color: #ddd; }
a.pilcrow[href]:hover { text-decoration: none; }
@media screen {
  :hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 500px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    display: relative;
    padding: 32px 0 0;
    column-count: 2;
    column-gap: 20px;
  }
  #name-authors-addresses {
    position: absolute;
    top: 0px;
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #b76427;
  background-color: rgba(249, 232, 105, 0.3);
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: rgba(249, 232, 105, 0.3);
  border-radius: 3px;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Delegated Credentials for TLS</td>
<td class="right">April 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Barnes, et al.</td>
<td class="center">Expires 26 October 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-tls-subcerts-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-04-24" class="published">24 April 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-10-26">26 October 2020</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Barnes</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">S. Iyengar</div>
<div class="org">Facebook</div>
</div>
<div class="author">
      <div class="author-name">N. Sullivan</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">E. Rescorla</div>
<div class="org">Mozilla</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Delegated Credentials for TLS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The organizational separation between the operator of a TLS endpoint and the
certification authority can create limitations.  For example, the lifetime of
certificates, how they may be used, and the algorithms they support are
ultimately determined by the certification authority.  This document describes a
mechanism by which operators may delegate their own credentials for use in TLS,
without breaking compatibility with peers that do not support this
specification.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
  <a href="https://github.com/tlswg/tls-subcerts">https://github.com/tlswg/tls-subcerts</a>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 26 October 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions-and-terminology" class="xref">Conventions and Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-change-log" class="xref">Change Log</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-solution-overview" class="xref">Solution Overview</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-rationale" class="xref">Rationale</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1" class="keepWithNext"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-related-work" class="xref">Related Work</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1" class="keepWithNext"><a href="#section-4" class="xref">4</a>.  <a href="#name-delegated-credentials" class="xref">Delegated Credentials</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1" class="keepWithNext"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-client-and-server-behavior" class="xref">Client and Server behavior</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1" class="keepWithNext"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-server-authentication" class="xref">Server authentication</a><a href="#section-toc.1-1.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1" class="keepWithNext"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-client-authentication" class="xref">Client authentication</a><a href="#section-toc.1-1.4.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1" class="keepWithNext"><a href="#section-4.1.3" class="xref">4.1.3</a>.  <a href="#name-validating-a-delegated-cred" class="xref">Validating a Delegated Credential</a><a href="#section-toc.1-1.4.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1" class="keepWithNext"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-certificate-requirements" class="xref">Certificate Requirements</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1" class="keepWithNext"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1" class="keepWithNext"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1" class="keepWithNext"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-security-of-delegated-crede" class="xref">Security of delegated credential's private key</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1" class="keepWithNext"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-re-use-of-delegated-credent" class="xref">Re-use of delegated credentials in multiple contexts</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1" class="keepWithNext"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-revocation-of-delegated-cre" class="xref">Revocation of delegated credentials</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1" class="keepWithNext"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-interactions-with-session-r" class="xref">Interactions with session resumption</a><a href="#section-toc.1-1.6.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1" class="keepWithNext"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-privacy-considerations" class="xref">Privacy considerations</a><a href="#section-toc.1-1.6.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1" class="keepWithNext"><a href="#section-6.6" class="xref">6.6</a>.  <a href="#name-the-impact-of-signature-for" class="xref">The impact of signature forgery attacks</a><a href="#section-toc.1-1.6.2.6.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1" class="keepWithNext"><a href="#section-7" class="xref">7</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1" class="keepWithNext"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1" class="keepWithNext"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1" class="keepWithNext"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1" class="keepWithNext"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-asn1-module" class="xref">ASN.1 Module</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1" class="keepWithNext"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Typically, a TLS server uses a certificate provided by some entity other than
the operator of the server (a "Certification Authority" or CA) <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>
        <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>.  This organizational separation makes the TLS server operator
dependent on the CA for some aspects of its operations, for example:<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-1-2.1">Whenever the server operator wants to deploy a new certificate, it has to
interact with the CA.<a href="#section-1-2.1" class="pilcrow">¶</a>
</li>
<li id="section-1-2.2">The server operator can only use TLS signature schemes for which the CA
will issue credentials.<a href="#section-1-2.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-1-3">These dependencies cause problems in practice.  Server operators often deploy
TLS termination services in locations such as remote data centers
or Content Delivery Networks (CDNs) where it may be difficult to detect key
compromises.  Short-lived certificates may be used to limit the exposure of keys
in these cases.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">However, short-lived certificates need to be renewed more frequently than
long-lived certificates.  If an external CA is unable to issue a certificate in
time to replace a deployed certificate, the server would no longer be able to
present a valid certificate to clients.  With short-lived certificates, there is
a smaller window of time to renew a certificates and therefore a higher risk that
an outage at a CA will negatively affect the uptime of the service.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">To reduce the dependency on external CAs, this document proposes a limited delegation
mechanism that allows a TLS peer to issue its own credentials within
the scope of a certificate issued by an external CA.  These credentials only enable the
recipient of the delegation to speak for names that the CA has authorized.  For
clarity, we will refer to the certificate issued by the CA as a "certificate",
or "delegation certificate", and the one issued by the operator as a "delegated
credential" or "DC".<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-2">
      <h2 id="name-conventions-and-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
"OPTIONAL" in this document are to be interpreted as described in BCP
14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all
capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="change-log">
<section id="section-2.1">
        <h3 id="name-change-log">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
        </h3>
<p id="section-2.1-1">(*) indicates changes to the wire protocol.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">draft-08<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.1-3.1">Include details about the impact of signature forgery attacks<a href="#section-2.1-3.1" class="pilcrow">¶</a>
</li>
<li id="section-2.1-3.2">Copy edits<a href="#section-2.1-3.2" class="pilcrow">¶</a>
</li>
<li id="section-2.1-3.3">Fix section about DC reuse<a href="#section-2.1-3.3" class="pilcrow">¶</a>
</li>
<li id="section-2.1-3.4">Incorporate feedback from Jonathan Hammell and Kevin Jacobs on the list<a href="#section-2.1-3.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-2.1-4">draft-07<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.1-5.1">Minor text improvements<a href="#section-2.1-5.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-2.1-6">draft-06<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.1-7.1">Modified IANA section, fixed nits<a href="#section-2.1-7.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-2.1-8">draft-05<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.1-9.1">Removed support for PKCS 1.5 RSA signature algorithms.<a href="#section-2.1-9.1" class="pilcrow">¶</a>
</li>
<li id="section-2.1-9.2">Additional security considerations.<a href="#section-2.1-9.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-2.1-10">draft-04<a href="#section-2.1-10" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.1-11.1">Add support for client certificates.<a href="#section-2.1-11.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-2.1-12">draft-03<a href="#section-2.1-12" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.1-13.1">Remove protocol version from the Credential structure. (*)<a href="#section-2.1-13.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-2.1-14">draft-02<a href="#section-2.1-14" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.1-15.1">Change public key type. (*)<a href="#section-2.1-15.1" class="pilcrow">¶</a>
</li>
<li id="section-2.1-15.2">Change DelegationUsage extension to be NULL and define its object identifier.<a href="#section-2.1-15.2" class="pilcrow">¶</a>
</li>
<li id="section-2.1-15.3">Drop support for TLS 1.2.<a href="#section-2.1-15.3" class="pilcrow">¶</a>
</li>
<li id="section-2.1-15.4">Add the protocol version and credential signature algorithm to the
Credential structure. (*)<a href="#section-2.1-15.4" class="pilcrow">¶</a>
</li>
<li id="section-2.1-15.5">Specify undefined behavior in a few cases: when the client receives a DC
without indicated support; when the client indicates the extension in an
invalid protocol version; and when DCs are sent as extensions to
certificates other than the end-entity certificate.<a href="#section-2.1-15.5" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
<div id="solution-overview">
<section id="section-3">
      <h2 id="name-solution-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-solution-overview" class="section-name selfRef">Solution Overview</a>
      </h2>
<p id="section-3-1">A delegated credential is a digitally signed data structure with two semantic
fields: a validity interval and a public key (along with its associated
signature algorithm).  The signature on the credential indicates a delegation
from the certificate that is issued to the peer.  The secret key
used to sign a credential corresponds to the public key of the peer's
X.509 end-entity certificate <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">A TLS handshake that uses delegated credentials differs from a standard handshake
in a few important ways:<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-3-3.1">The initiating peer provides an extension in its ClientHello or CertificateRequest
that indicates support for this mechanism.<a href="#section-3-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3-3.2">The peer sending the Certificate message provides both the certificate
chain terminating in its certificate as well as the delegated credential.<a href="#section-3-3.2" class="pilcrow">¶</a>
</li>
<li id="section-3-3.3">The authenticating initiator uses information from the peer's certificate
to verify the delegated credential and that the peer is asserting an
expected identity.<a href="#section-3-3.3" class="pilcrow">¶</a>
</li>
<li id="section-3-3.4">Peers accepting the delegated credential use it as the certificate
key for the TLS handshake<a href="#section-3-3.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3-4">As detailed in <a href="#delegated-credentials" class="xref">Section 4</a>, the delegated credential is
cryptographically bound to the end-entity certificate with which the
credential may be used.  This document specifies the use of delegated
credentials in TLS 1.3 or later; their use in prior versions of the
protocol is not allowed.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Delegated credentials allow a peer to terminate TLS connections on behalf of
the certificate owner.  If a credential is stolen, there is no mechanism for
revoking it without revoking the certificate itself.  To limit exposure in case
of delegated credential private key compromise, delegated credentials have a maximum
validity period.  In the absence of an application profile standard specifying
otherwise, the maximum validity period is set to 7 days.  Peers MUST NOT issue
credentials with a validity period longer than the maximum validity period.
This mechanism is described in detail in <a href="#client-and-server-behavior" class="xref">Section 4.1</a>.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">It was noted in <span>[<a href="#XPROT" class="xref">XPROT</a>]</span> that certificates in use by servers that support
outdated protocols such as SSLv2 can be used to forge signatures for
certificates that contain the keyEncipherment KeyUsage (<span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> section
4.2.1.3).  In order to prevent this type of cross-protocol attack, we define a
new DelegationUsage extension to X.509 that permits use of delegated
credentials.  (See <a href="#certificate-requirements" class="xref">Section 4.2</a>.)<a href="#section-3-6" class="pilcrow">¶</a></p>
<div id="rationale">
<section id="section-3.1">
        <h3 id="name-rationale">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-rationale" class="section-name selfRef">Rationale</a>
        </h3>
<p id="section-3.1-1">Delegated credentials present a better alternative than other delegation
mechanisms like proxy certificates <span>[<a href="#RFC3820" class="xref">RFC3820</a>]</span> for several reasons:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.1-2.1">There is no change needed to certificate validation at the PKI layer.<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
<li id="section-3.1-2.2">X.509 semantics are very rich.  This can cause unintended consequences if a
service owner creates a proxy certificate where the properties differ from the leaf
certificate.  For this reason, delegated credentials have very restricted
semantics that should not conflict with X.509 semantics.<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
<li id="section-3.1-2.3">Proxy certificates rely on the certificate path building process to establish
a binding between the proxy certificate and the server certificate.  Since
the certificate path building process is not cryptographically protected, it is
possible that a proxy certificate could be bound to another certificate with
the same public key, with different X.509 parameters.  Delegated credentials,
which rely on a cryptographic binding between the entire certificate and the
delegated credential, cannot.<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
<li id="section-3.1-2.4">Each delegated credential is bound to a specific signature algorithm that may
be used to sign the TLS handshake (<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> section 4.2.3).  This prevents
them from being used with other, perhaps unintended signature algorithms.<a href="#section-3.1-2.4" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="related-work">
<section id="section-3.2">
        <h3 id="name-related-work">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-related-work" class="section-name selfRef">Related Work</a>
        </h3>
<p id="section-3.2-1">Many of the use cases for delegated credentials can also be addressed using
purely server-side mechanisms that do not require changes to client behavior
(e.g., a PKCS#11 interface or a remote signing mechanism <span>[<a href="#KEYLESS" class="xref">KEYLESS</a>]</span>).  These
mechanisms, however, incur per-transaction latency, since the front-end
server has to interact with a back-end server that holds a private key.  The
mechanism proposed in this document allows the delegation to be done
off-line, with no per-transaction latency.  The figure below compares the
message flows for these two mechanisms
with TLS 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-2">
<pre>
Remote key signing:

Client            Front-End            Back-End
  |----ClientHello---&gt;|                    |
  |&lt;---ServerHello----|                    |
  |&lt;---Certificate----|                    |
  |                   |&lt;---remote sign----&gt;|
  |&lt;---CertVerify-----|                    |
  |        ...        |                    |


Delegated credentials:

Client            Front-End            Back-End
  |                   |&lt;--DC distribution-&gt;|
  |----ClientHello---&gt;|                    |
  |&lt;---ServerHello----|                    |
  |&lt;---Certificate----|                    |
  |&lt;---CertVerify-----|                    |
  |        ...        |                    |
</pre><a href="#section-3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2-3">These two mechanisms can be complementary.  A server could use credentials for
clients that support them, while using <span>[<a href="#KEYLESS" class="xref">KEYLESS</a>]</span> to support legacy clients.
The private key for a delegated credential can be used in place of a certificate
private key, so it is important that the Front-End and Back-End are parties that
have a trusted relationship.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Use of short-lived certificates with automated certificate issuance,
e.g., with Automated Certificate Managment Environment (ACME) <span>[<a href="#RFC8555" class="xref">RFC8555</a>]</span>,
reduces the risk of key compromise, but has several limitations.
Specifically, it introduces an operationally-critical dependency on an
external party.  It also
limits the types of algorithms supported for TLS authentication to those
the CA is willing to issue a certificate for.  Nonetheless, existing
automated issuance APIs like ACME may be useful for provisioning delegated credentials.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="delegated-credentials">
<section id="section-4">
      <h2 id="name-delegated-credentials">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-delegated-credentials" class="section-name selfRef">Delegated Credentials</a>
      </h2>
<p id="section-4-1">While X.509 forbids end-entity certificates from being used as issuers for
other certificates, it is valid to use them to issue other signed
objects as long as the certificate contains the digitalSignature KeyUsage
(<span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> section 4.2.1.3).  We define a new signed object format that would
encode only the semantics that are needed for this application.  The credential
has the following structure:<a href="#section-4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4-2">
<pre>
   struct {
     uint32 valid_time;
     SignatureScheme expected_cert_verify_algorithm;
     opaque ASN1_subjectPublicKeyInfo&lt;1..2^24-1&gt;;
   } Credential;
</pre><a href="#section-4-2" class="pilcrow">¶</a>
</div>
<dl class="dlParallel" id="section-4-3">
        <dt id="section-4-3.1">valid_time:</dt>
<dd id="section-4-3.2">
  Time in seconds relative to the beginning of the delegation certificate's
notBefore value after which the delegated credential is no longer valid. This MUST NOT exceed 7 days.<a href="#section-4-3.2" class="pilcrow">¶</a>
</dd>
<dt id="section-4-3.3">expected_cert_verify_algorithm:</dt>
<dd id="section-4-3.4">
  The signature algorithm of the credential key pair, where the type
SignatureScheme is as defined in <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>. This is expected to be
the same as CertificateVerify.algorithm sent by the server.  Only signature
algorithms allowed for use in CertificateVerify messages are allowed.  When
using RSA, the public key MUST NOT use the rsaEncryption OID, as a result,
the following algorithms are not allowed for use with delegated credentials:
rsa_pss_rsae_sha256, rsa_pss_rsae_sha384, rsa_pss_rsae_sha512.<a href="#section-4-3.4" class="pilcrow">¶</a>
</dd>
<dt id="section-4-3.5">ASN1_subjectPublicKeyInfo:</dt>
<dd id="section-4-3.6">
  The credential's public key, a DER-encoded <span>[<a href="#X.690" class="xref">X.690</a>]</span> SubjectPublicKeyInfo as defined in
<span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>.<a href="#section-4-3.6" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-4-4">The delegated credential has the following structure:<a href="#section-4-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4-5">
<pre>
   struct {
     Credential cred;
     SignatureScheme algorithm;
     opaque signature&lt;0..2^16-1&gt;;
   } DelegatedCredential;
</pre><a href="#section-4-5" class="pilcrow">¶</a>
</div>
<dl class="dlParallel" id="section-4-6">
        <dt id="section-4-6.1">algorithm:</dt>
<dd id="section-4-6.2">
  The signature algorithm used to verify DelegatedCredential.signature.<a href="#section-4-6.2" class="pilcrow">¶</a>
</dd>
<dt id="section-4-6.3">signature:</dt>
<dd id="section-4-6.4">
  The delegation, a signature that binds the credential to the end-entity
certificate's public key as specified below. The signature scheme is specified
by DelegatedCredential.algorithm.<a href="#section-4-6.4" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-4-7">The signature of the DelegatedCredential is computed over the concatenation of:<a href="#section-4-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4-8">
        <li id="section-4-8.1">A string that consists of octet 32 (0x20) repeated 64 times.<a href="#section-4-8.1" class="pilcrow">¶</a>
</li>
<li id="section-4-8.2">The context string "TLS, server delegated credentials" for servers and "TLS, client delegated credentials" for clients.<a href="#section-4-8.2" class="pilcrow">¶</a>
</li>
<li id="section-4-8.3">A single 0 byte, which serves as the separator.<a href="#section-4-8.3" class="pilcrow">¶</a>
</li>
<li id="section-4-8.4">The DER-encoded X.509 end-entity certificate used to sign the
DelegatedCredential.<a href="#section-4-8.4" class="pilcrow">¶</a>
</li>
<li id="section-4-8.5">DelegatedCredential.cred.<a href="#section-4-8.5" class="pilcrow">¶</a>
</li>
<li id="section-4-8.6">DelegatedCredential.algorithm.<a href="#section-4-8.6" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-4-9">The signature effectively binds the credential to the parameters of the
handshake in which it is used.  In particular, it ensures that credentials are
only used with the certificate and signature algorithm chosen by the
delegator.<a href="#section-4-9" class="pilcrow">¶</a></p>
<p id="section-4-10">The code changes required in order to create and verify delegated credentials,
and the implementation complexity this entails, are localized to the TLS
stack.  This has the advantage of avoiding changes to security-critical and
often delicate PKI code.<a href="#section-4-10" class="pilcrow">¶</a></p>
<div id="client-and-server-behavior">
<section id="section-4.1">
        <h3 id="name-client-and-server-behavior">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-client-and-server-behavior" class="section-name selfRef">Client and Server behavior</a>
        </h3>
<p id="section-4.1-1">This document defines the following TLS extension code point.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-2">
<pre>
   enum {
     ...
     delegated_credential(34),
     (65535)
   } ExtensionType;
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<div id="server-authentication">
<section id="section-4.1.1">
          <h4 id="name-server-authentication">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-server-authentication" class="section-name selfRef">Server authentication</a>
          </h4>
<p id="section-4.1.1-1">A client which supports this specification SHALL send a
"delegated_credential" extension in its ClientHello. The body of the extension
consists of a SignatureSchemeList:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.1-2">
<pre>
   struct {
     SignatureScheme supported_signature_algorithm&lt;2..2^16-2&gt;;
   } SignatureSchemeList;
</pre><a href="#section-4.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-3">If the client receives a delegated credential without indicating support,
then the client MUST abort with an "unexpected_message" alert.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">If the extension is present, the server MAY send a delegated credential; if the
extension is not present, the server MUST NOT send a delegated credential.
The server MUST ignore the extension unless TLS 1.3 or a later version is
negotiated.<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.1-5">The server MUST send the delegated credential as an extension in the
CertificateEntry of its end-entity certificate; the client SHOULD ignore
delegated credentials sent as extensions to any other certificate.<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1.1-6">The expected_cert_verify_algorithm field MUST be of a
type advertised by the client in the SignatureSchemeList and is
considered invalid otherwise.  Clients that receive invalid delegated
credentials MUST terminate the connection with an "illegal_parameter"
alert.<a href="#section-4.1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-authentication">
<section id="section-4.1.2">
          <h4 id="name-client-authentication">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-client-authentication" class="section-name selfRef">Client authentication</a>
          </h4>
<p id="section-4.1.2-1">A server that supports this specification SHALL send a
"delegated_credential" extension in the CertificateRequest message
when requesting client authentication.  The body of the
extension consists of a SignatureSchemeList.  If the server receives a
delegated credential without indicating support in its
CertificateRequest, then the server MUST abort with an
"unexpected_message" alert.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">If the extension is present, the client MAY send a delegated credential; if the
extension is not present, the client MUST NOT send a delegated credential.
The client MUST ignore the extension unless TLS 1.3 or a later version is
negotiated.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-3">The client MUST send the delegated credential as an extension in the
CertificateEntry of its end-entity certificate; the server SHOULD ignore
delegated credentials sent as extensions to any other certificate.<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2-4">The algorithm field MUST be of a type advertised by the server
in the "signature_algorithms" extension of the CertificateRequest message
and the expected_cert_verify_algorithm field MUST be of a type
advertised by the server in the SignatureSchemeList
and considered invalid otherwise.  Servers that receive invalid
delegated credentials MUST terminate the connection with an
"illegal_parameter" alert.<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validating-a-delegated-credential">
<section id="section-4.1.3">
          <h4 id="name-validating-a-delegated-cred">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-validating-a-delegated-cred" class="section-name selfRef">Validating a Delegated Credential</a>
          </h4>
<p id="section-4.1.3-1">On receiving a delegated credential and a certificate chain, the peer
validates the certificate chain and matches the end-entity certificate to the
peer's expected identity.  It also takes the following steps:<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.3-2">
            <li id="section-4.1.3-2.1">Verify that the current time is within the validity interval of the credential.
This is done by asserting that the current time is no more than the
delegation certificate's notBefore value plus DelegatedCredential.cred.valid_time.
2  Verify that the credential's remaining validity time is no more than the maximum validity
period. This is done by asserting that the current time is no more than the delegation
certificate's notBefore value plus DelegatedCredential.cred.valid_time plus
the maximum validity period.<a href="#section-4.1.3-2.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1.3-2.2">Verify that expected_cert_verify_algorithm matches
the scheme indicated in the peer's CertificateVerify message and that the
algorithm is allowed for use with delegated credentials.<a href="#section-4.1.3-2.2" class="pilcrow">¶</a>
</li>
<li id="section-4.1.3-2.3">Verify that the end-entity certificate satisfies the conditions in
<a href="#certificate-requirements" class="xref">Section 4.2</a>.<a href="#section-4.1.3-2.3" class="pilcrow">¶</a>
</li>
<li id="section-4.1.3-2.4">Use the public key in the peer's end-entity certificate to verify the
signature of the credential using the algorithm indicated by
DelegatedCredential.algorithm.<a href="#section-4.1.3-2.4" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-4.1.3-3">If one or more of these checks fail, then the delegated credential is deemed
invalid.  Clients and servers that receive invalid delegated credentials MUST terminate the
connection with an "illegal_parameter" alert.  If successful, the participant
receiving the Certificate message uses the public key in the credential to verify
the signature in the peer's CertificateVerify message.<a href="#section-4.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="certificate-requirements">
<section id="section-4.2">
        <h3 id="name-certificate-requirements">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-certificate-requirements" class="section-name selfRef">Certificate Requirements</a>
        </h3>
<p id="section-4.2-1">We define a new X.509 extension, DelegationUsage, to be used in the certificate
when the certificate permits the usage of delegated credentials.  What follows
is the ASN.1 <span>[<a href="#X.680" class="xref">X.680</a>]</span> for the DelegationUsage certificate extension.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2-2">
<pre>
    ext-delegationUsage EXTENSION  ::= {
        SYNTAX DelegationUsage IDENTIFIED BY id-ce-delegationUsage
    }

    DelegationUsage ::= NULL

    id-ce-delegationUsage OBJECT IDENTIFIER ::=
        { iso(1) identified-organization(3) dod(6) internet(1)
          private(4) enterprise(1) id-cloudflare(44363) 44 }
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2-3">The extension MUST be marked non-critical.  (See Section 4.2 of <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>.)
The client MUST NOT accept a delegated credential unless the server's end-entity
certificate satisfies the following criteria:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.2-4.1">It has the DelegationUsage extension.<a href="#section-4.2-4.1" class="pilcrow">¶</a>
</li>
<li id="section-4.2-4.2">It has the digitalSignature KeyUsage (see the KeyUsage extension defined in
<span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>).<a href="#section-4.2-4.2" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">This document registers the "delegated_credentials" extension in the
"TLS ExtensionType Values" registry.  The "delegated_credentials"
extension has been assigned a code point of 34.  The IANA registry
lists this extension as "Recommended" (i.e., "Y") and indicates that
it may appear in the ClientHello (CH), CertificateRequest (CR),
or Certificate (CT) messages in TLS 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">This document also defines an ASN.1 module for the DelegationUsage
certificate extension in <a href="#module" class="xref">Appendix A</a>.  IANA is requested to register an
Object Identfiier (OID) for the ASN.1 in "SMI Security for PKIX Module
Identifier" arc.  An OID for the DelegationUsage certificate extension
is not needed as it is already assigned to the extension from
Cloudflare's IANA Private Enterprise Number (PEN) arc.<a href="#section-5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="security-of-delegated-credentials-private-key">
<section id="section-6.1">
        <h3 id="name-security-of-delegated-crede">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-security-of-delegated-crede" class="section-name selfRef">Security of delegated credential's private key</a>
        </h3>
<p id="section-6.1-1">Delegated credentials limit the exposure of the private key used in a TLS connection by limiting
its validity period.  An attacker who compromises the private key of a delegated
credential can act as a man-in-the-middle until the delegated credential expires.
However, they cannot create new delegated credentials.  Thus, delegated
credentials should not be used to send a delegation to an untrusted party, but
is meant to be used between parties that have some trust relationship with each
other.  The secrecy of the delegated credential's private key is thus important and
access control mechanisms SHOULD be used to protect it, including file system
controls, physical security, or hardware security modules.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="re-use-of-delegated-credentials-in-multiple-contexts">
<section id="section-6.2">
        <h3 id="name-re-use-of-delegated-credent">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-re-use-of-delegated-credent" class="section-name selfRef">Re-use of delegated credentials in multiple contexts</a>
        </h3>
<p id="section-6.2-1">It is not possible to use the same delegated credential for both client and server
authentication because issuing parties compute the corresponding signature using a context string unique to the intended role (client or server).<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="revocation-of-delegated-credentials">
<section id="section-6.3">
        <h3 id="name-revocation-of-delegated-cre">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-revocation-of-delegated-cre" class="section-name selfRef">Revocation of delegated credentials</a>
        </h3>
<p id="section-6.3-1">Delegated credentials do not provide any additional form of early revocation.
Since it is short lived, the expiry of the delegated credential would revoke
the credential.  Revocation of the long term private key that signs the
delegated credential also implicitly revokes the delegated credential.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="interactions-with-session-resumption">
<section id="section-6.4">
        <h3 id="name-interactions-with-session-r">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-interactions-with-session-r" class="section-name selfRef">Interactions with session resumption</a>
        </h3>
<p id="section-6.4-1">If a client decides to cache the certificate chain and re-validate it
when resuming a connection, the client SHOULD also cache the associated
delegated credential and re-validate it.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-6.5">
        <h3 id="name-privacy-considerations">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy considerations</a>
        </h3>
<p id="section-6.5-1">Delegated credentials can be valid for 7 days and it is much easier for a
service to create delegated credential than a certificate signed by a CA.  A
service could determine the client time and clock skew by creating several
delegated credentials with different expiry timestamps and observing whether the
client would accept it.  Client time could be unique and thus privacy sensitive
clients, such as browsers in incognito mode, who do not trust the service might
not want to advertise support for delegated credentials or limit the number of
probes that a server can perform.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-impact-of-signature-forgery-attacks">
<section id="section-6.6">
        <h3 id="name-the-impact-of-signature-for">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-the-impact-of-signature-for" class="section-name selfRef">The impact of signature forgery attacks</a>
        </h3>
<p id="section-6.6-1">When TLS 1.2 servers support RSA key exchange, they may be vulnerable to attacks
that allow forging an RSA signature over an arbitrary message <span>[<a href="#BLEI" class="xref">BLEI</a>]</span>.
TLS 1.2 <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> (Section 7.4.7.1.) describes a mitigation strategy requiring
careful implementation of timing resistant countermeasures for preventing these attacks.
Experience shows that in practice, server implementations may fail to fully
stop these attacks due to the complexity of this mitigation <span>[<a href="#ROBOT" class="xref">ROBOT</a>]</span>.
For TLS 1.2 servers that support RSA key exchange using a DC-enabled end-entity
certificate, a hypothetical signature forgery attack would allow forging a
signature over a delegated credential.
The forged credential could then be used by the attacker as the equivalent of a
man-in-the-middle certificate, valid for 7 days.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<p id="section-6.6-2">Server operators should therefore minimize the risk of using DC-enabled
end-entity certificates where a signature forgery oracle may be present.
If possible, server operators may choose to use DC-enabled certificates only for signing
credentials, and not for serving non-DC TLS traffic.
Furthermore, server operators may use elliptic curve certificates for DC-enabled
traffic, while using RSA certificates without the DelegationUsage certificate
extension for non-DC traffic; this completely prevents such attacks.<a href="#section-6.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-7">
      <h2 id="name-acknowledgements">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-7-1">Thanks to David Benjamin, Christopher Patton, Kyle Nekritz, Anirudh Ramachandran, Benjamin
Kaduk, Kazuho Oku, Daniel Kahn Gillmor, Watson Ladd, Robert Merget, Juraj
Somorovsky, Nimrod Aviram for their discussions, ideas,
and bugs they have found.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC5280">[RFC5280]</dt>
<dd>
<span class="refAuthor">Cooper, D.</span><span class="refAuthor">, Santesson, S.</span><span class="refAuthor">, Farrell, S.</span><span class="refAuthor">, Boeyen, S.</span><span class="refAuthor">, Housley, R.</span><span class="refAuthor">, and W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dt id="RFC8446">[RFC8446]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dt id="X.680">[X.680]</dt>
<dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation"</span>, <span class="seriesInfo">ISO/IEC 8824-1:2015</span>, <time datetime="2015-11">November 2015</time>. </dd>
<dt id="X.690">[X.690]</dt>
<dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - ASN.1 encoding Rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ISO/IEC 8825-1:2015</span>, <time datetime="2015-11">November 2015</time>. </dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BLEI">[BLEI]</dt>
<dd>
<span class="refAuthor">Bleichenbacher, D.</span>, <span class="refTitle">"Chosen Ciphertext Attacks against Protocols Based on RSA Encryption Standard PKCS #1"</span>, <span class="seriesInfo">Advances in Cryptology -- CRYPTO'98, LNCS vol. 1462, pages: 1-12 </span>, <time datetime="1998">1998</time>. </dd>
<dt id="KEYLESS">[KEYLESS]</dt>
<dd>
<span class="refAuthor">Sullivan, N.</span><span class="refAuthor"> and D. Stebila</span>, <span class="refTitle">"An Analysis of TLS Handshake Proxying"</span>, <span class="seriesInfo">IEEE Trustcom/BigDataSE/ISPA 2015 </span>, <time datetime="2015">2015</time>. </dd>
<dt id="RFC3820">[RFC3820]</dt>
<dd>
<span class="refAuthor">Tuecke, S.</span><span class="refAuthor">, Welch, V.</span><span class="refAuthor">, Engert, D.</span><span class="refAuthor">, Pearlman, L.</span><span class="refAuthor">, and M. Thompson</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure (PKI) Proxy Certificate Profile"</span>, <span class="seriesInfo">RFC 3820</span>, <span class="seriesInfo">DOI 10.17487/RFC3820</span>, <time datetime="2004-06">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3820">https://www.rfc-editor.org/info/rfc3820</a>&gt;</span>. </dd>
<dt id="RFC5246">[RFC5246]</dt>
<dd>
<span class="refAuthor">Dierks, T.</span><span class="refAuthor"> and E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;</span>. </dd>
<dt id="RFC5912">[RFC5912]</dt>
<dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor"> and J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 5912</span>, <span class="seriesInfo">DOI 10.17487/RFC5912</span>, <time datetime="2010-06">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5912">https://www.rfc-editor.org/info/rfc5912</a>&gt;</span>. </dd>
<dt id="RFC8555">[RFC8555]</dt>
<dd>
<span class="refAuthor">Barnes, R.</span><span class="refAuthor">, Hoffman-Andrews, J.</span><span class="refAuthor">, McCarney, D.</span><span class="refAuthor">, and J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8555">https://www.rfc-editor.org/info/rfc8555</a>&gt;</span>. </dd>
<dt id="ROBOT">[ROBOT]</dt>
<dd>
<span class="refAuthor">Boeck, H.</span><span class="refAuthor">, Somorovsky, J.</span><span class="refAuthor">, and C. Young</span>, <span class="refTitle">"Return Of Bleichenbacher's Oracle Threat (ROBOT)"</span>, <span class="seriesInfo">27th USENIX Security Symposium </span>, <time datetime="2018">2018</time>. </dd>
<dt id="XPROT">[XPROT]</dt>
<dd>
<span class="refAuthor">Jager, T.</span><span class="refAuthor">, Schwenk, J.</span><span class="refAuthor">, and J. Somorovsky</span>, <span class="refTitle">"On the Security of TLS 1.3 and QUIC Against Weaknesses in PKCS#1 v1.5 Encryption"</span>, <span class="seriesInfo">Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security </span>, <time datetime="2015">2015</time>. </dd>
</dl>
</section>
</section>
<div id="module">
<section id="section-appendix.a">
      <h2 id="name-asn1-module">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-asn1-module" class="section-name selfRef">ASN.1 Module</a>
      </h2>
<p id="section-appendix.a-1">The following ASN.1 module provides the complete definition of the
DelegationUsage certificate extension.  The ASN.1 module makes imports
from <span>[<a href="#RFC5912" class="xref">RFC5912</a>]</span>.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-appendix.a-2">
<pre>
DelegatedCredentialExtn
  { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-delegated-credential-extn(TBD) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

-- EXPORT ALL

IMPORTS

EXTENSION
  FROM PKIX-CommonTypes-2009 -- From RFC 5912
  { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-pkixCommon-02(57) } ;

-- OID

id-cloudflare OBJECT IDENTIFIER ::=
  { iso(1) identified-organization(3) dod(6) internet(1) private(4)
    enterprise(1) 44363 }

-- EXTENSION

ext-delegationUsage EXTENSION ::=
  { SYNTAX DelegationUsage
    IDENTIFIED BY id-ce-delegationUsage }

id-ce-delegationUsage OBJECT IDENTIFIER ::= { id-cloudflare 44 }

DelegationUsage ::= NULL

END
</pre><a href="#section-appendix.a-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Richard Barnes</span></div>
<div dir="auto" class="left"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rlb@ipv.sx" class="email">rlb@ipv.sx</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Subodh Iyengar</span></div>
<div dir="auto" class="left"><span class="org">Facebook</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:subodh@fb.com" class="email">subodh@fb.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Nick Sullivan</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:nick@cloudflare.com" class="email">nick@cloudflare.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Eric Rescorla</span></div>
<div dir="auto" class="left"><span class="org">Mozilla</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ekr@rtfm.com" class="email">ekr@rtfm.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
